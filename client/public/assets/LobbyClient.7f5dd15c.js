import{S as W,i as q,s as F,e as I,a as h,c as C,b as R,d as b,m as G,g as N,t as g,f as j,h as w,j as k,k as L,l as z,p as J,o as K,n as Q,_ as E,q as P,P as X,r as S,u as Y,v as D,w as Z,x,y as $,z as ee,A as ne,B as _}from"./index.7dfcd9fb.js";import{W as te,G as H,L as le}from"./Game.cb56fc56.js";function M(r){r[17]=r[18].default}function se(r){let s,n,l,o,e,a,c,m,u=r[1]&&O(r);return l=new le({props:{players:r[0],thisPlayerId:r[3]}}),{c(){s=I("div"),u&&u.c(),n=h(),C(l.$$.fragment),o=h(),e=I("button"),e.textContent="Leave",R(s,"class","container group kod")},m(t,f){b(t,s,f),u&&u.m(s,null),b(t,n,f),G(l,t,f),b(t,o,f),b(t,e,f),a=!0,c||(m=Y(e,"click",r[8]),c=!0)},p(t,f){t[1]?u?u.p(t,f):(u=O(t),u.c(),u.m(s,null)):u&&(u.d(1),u=null);const d={};f&1&&(d.players=t[0]),f&8&&(d.thisPlayerId=t[3]),l.$set(d)},i(t){a||(w(l.$$.fragment,t),a=!0)},o(t){g(l.$$.fragment,t),a=!1},d(t){t&&k(s),u&&u.d(),t&&k(n),L(l,t),t&&k(o),t&&k(e),c=!1,m()}}}function oe(r){let s,n,l,o={ctx:r,current:null,token:null,hasCatch:!1,pending:ie,then:ae,catch:re,value:18,blocks:[,,,]};return D(n=r[5],o),{c(){s=Z(),o.block.c()},m(e,a){b(e,s,a),o.block.m(e,o.anchor=a),o.mount=()=>s.parentNode,o.anchor=s,l=!0},p(e,a){r=e,o.ctx=r,a&32&&n!==(n=r[5])&&D(n,o)||x(o,r,a)},i(e){l||(w(o.block),l=!0)},o(e){for(let a=0;a<3;a+=1){const c=o.blocks[a];g(c)}l=!1},d(e){e&&k(s),o.block.d(e),o.token=null,o=null}}}function O(r){let s,n,l,o;return{c(){s=I("div"),s.textContent="game code:",n=h(),l=I("div"),o=$(r[1])},m(e,a){b(e,s,a),b(e,n,a),b(e,l,a),ee(l,o)},p(e,a){a&2&&ne(o,e[1])},d(e){e&&k(s),e&&k(n),e&&k(l)}}}function re(r){return{c:_,m:_,p:_,i:_,o:_,d:_}}function ae(r){M(r);let s,n;return s=new r[17]({props:{gameId:r[1],socket:r[2],thisPlayerId:r[3],isHost:!1,kickPlayer:ue,game:r[4],closeGame:ce}}),s.$on("leave",r[8]),s.$on("gameFinished",r[9]),{c(){C(s.$$.fragment)},m(l,o){G(s,l,o),n=!0},p(l,o){M(l);const e={};o&2&&(e.gameId=l[1]),o&4&&(e.socket=l[2]),o&8&&(e.thisPlayerId=l[3]),o&16&&(e.game=l[4]),s.$set(e)},i(l){n||(w(s.$$.fragment,l),n=!0)},o(l){g(s.$$.fragment,l),n=!1},d(l){L(s,l)}}}function ie(r){return{c:_,m:_,p:_,i:_,o:_,d:_}}function fe(r){let s,n,l,o,e,a;const c=[oe,se],m=[];function u(t,f){return t[5]?0:1}return n=u(r),l=m[n]=c[n](r),e=new te({props:{showModal:r[6],winnerUsername:r[7],close:r[12]}}),{c(){s=I("div"),l.c(),o=h(),C(e.$$.fragment),R(s,"class","container")},m(t,f){b(t,s,f),m[n].m(s,null),b(t,o,f),G(e,t,f),a=!0},p(t,[f]){let d=n;n=u(t),n===d?m[n].p(t,f):(N(),g(m[d],1,1,()=>{m[d]=null}),j(),l=m[n],l?l.p(t,f):(l=m[n]=c[n](t),l.c()),w(l,1),l.m(s,null));const y={};f&64&&(y.showModal=t[6]),f&128&&(y.winnerUsername=t[7]),f&96&&(y.close=t[12]),e.$set(y)},i(t){a||(w(l),w(e.$$.fragment,t),a=!0)},o(t){g(l),g(e.$$.fragment,t),a=!1},d(t){t&&k(s),m[n].d(),t&&k(o),L(e,t)}}}const ue=()=>{},ce=()=>{};function me(r,s,n){let{gameId:l}=s,{socket:o}=s,{players:e=[]}=s,{thisPlayerId:a}=s,{startedGameInfo:c}=s;const m=z();let u,t,f,d=!1,y="";const T=J.subscribe(i=>{});K(()=>{T()}),Q(()=>{if(console.log("started game info? ",c),c){let i={};i[a]=c.newHand,f={startingPlayerId:c.currentPlayer,newHands:i},n(4,u=new H(e,f,a)),n(4,u.previousBet=c.currentBet,u),console.log("players ",u.players,e),n(5,t=E(()=>import("./GameView.310342a8.js"),["assets/GameView.310342a8.js","assets/index.7dfcd9fb.js","assets/index.49f28f53.css","assets/Card.97ea3429.js","assets/GameView.1b0781ce.css"]))}o.on(P.newPlayerJoined,i=>{console.debug("New player in lobby name:",i.username);let p=new X(i.uid,i.username);p.isOnline=!0,n(0,e=[...e,p])}),o.on(P.gameStarted,i=>{console.debug("reveived game start message",i),i&&i.startingPlayerId&&(f=i,console.log("gsdata ",f,a,f.newHands[a]),n(4,u=new H(e,f,a)),n(4,u.gameClosed=!1,u),n(5,t=E(()=>import("./GameView.310342a8.js"),["assets/GameView.310342a8.js","assets/index.7dfcd9fb.js","assets/index.49f28f53.css","assets/Card.97ea3429.js","assets/GameView.1b0781ce.css"])))}),o.on(P.gameClosed,()=>{m("gameClosed")}),o.on(P.playerLeftGame,i=>{if(!!i){if(i.uid==a){n(0,e=[]),m("gameClosed");return}if(t){let p=e.find(V=>V.uid===i.uid);p&&(p.isOnline=!1)}else n(0,e=e.filter(p=>p.uid!==i.uid)),n(0,e)}})});function A(){o.emit(S.leaveGame)}function B(i){i.detail&&i.detail.username&&(n(7,y=i.detail.username),n(6,d=!0)),n(5,t=void 0)}function v(){console.log("why twice?"),o.emit(S.playerReady,a)}const U=()=>{n(6,d=!1),n(5,t=void 0),v()};return r.$$set=i=>{"gameId"in i&&n(1,l=i.gameId),"socket"in i&&n(2,o=i.socket),"players"in i&&n(0,e=i.players),"thisPlayerId"in i&&n(3,a=i.thisPlayerId),"startedGameInfo"in i&&n(11,c=i.startedGameInfo)},[e,l,o,a,u,t,d,y,A,B,v,c,U]}class be extends W{constructor(s){super(),q(this,s,me,fe,F,{gameId:1,socket:2,players:0,thisPlayerId:3,startedGameInfo:11})}}export{be as default};
