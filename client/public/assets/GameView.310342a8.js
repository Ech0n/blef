import{S as J,i as M,s as O,e as p,b as y,d as H,B as D,j as R,C as X,J as Y,D as G,K as U,a as Z,c as $,z as E,m as ee,u as te,h as re,t as se,k as ne,l as ae,o as le,n as oe,L as ie,q as d,I as q,M as ce}from"./index.7dfcd9fb.js";import{d as de,c as ue}from"./Card.97ea3429.js";function z(i,t,n){const a=i.slice();return a[2]=t[n],a[4]=n,a}function K(i){let t,n;return{c(){t=p("img"),Y(t,"--spread",fe),y(t,"class","karta svelte-1en9cxz"),y(t,"id","card"+i[4]),G(t.src,n=i[1].getCardImage(i[2][0]+" "+i[2][1]))||y(t,"src",n)},m(a,e){H(a,t,e)},p(a,e){e&1&&!G(t.src,n=a[1].getCardImage(a[2][0]+" "+a[2][1]))&&y(t,"src",n)},d(a){a&&R(t)}}}function me(i){let t,n=i[0],a=[];for(let e=0;e<n.length;e+=1)a[e]=K(z(i,n,e));return{c(){t=p("div");for(let e=0;e<a.length;e+=1)a[e].c();y(t,"class","hand svelte-1en9cxz")},m(e,c){H(e,t,c);for(let l=0;l<a.length;l+=1)a[l].m(t,null)},p(e,[c]){if(c&3){n=e[0];let l;for(l=0;l<n.length;l+=1){const u=z(e,n,l);a[l]?a[l].p(u,c):(a[l]=K(u),a[l].c(),a[l].m(t,null))}for(;l<a.length;l+=1)a[l].d(1);a.length=n.length}},i:D,o:D,d(e){e&&R(t),X(a,e)}}}let fe="35px";function he(i,t,n){let{hand:a}=t;const e=new U;return console.log(a),i.$$set=c=>{"hand"in c&&n(0,a=c.hand)},[a,e]}class ge extends J{constructor(t){super(),M(this,t,he,me,O,{hand:0})}}function ye(i){let t,n,a,e,c,l,u,h;return c=new ge({props:{hand:i[0].hand}}),{c(){t=p("div"),n=p("div"),n.textContent="\u2754",a=Z(),e=p("div"),$(c.$$.fragment),y(n,"class","helper svelte-113xvip"),y(e,"class","hand-wrapper svelte-113xvip"),y(t,"class","game-container svelte-113xvip")},m(r,k){H(r,t,k),E(t,n),E(t,a),E(t,e),ee(c,e,null),l=!0,u||(h=te(n,"click",i[8]),u=!0)},p(r,[k]){const I={};k&1&&(I.hand=r[0].hand),c.$set(I)},i(r){l||(re(c.$$.fragment,r),l=!0)},o(r){se(c.$$.fragment,r),l=!1},d(r){r&&R(t),ne(c),u=!1,h()}}}function ke(i,t,n){let{gameId:a}=t,{socket:e}=t,{kickPlayer:c}=t,{closeGame:l}=t,{thisPlayerId:u}=t,{isHost:h=!1}=t,{game:r}=t;const k=ae(),I=ce.BACKEND_SERVER_ADDRESS;let f=30,C,S,w=[],L=!1;new U;const b={2:"Two",3:"Three",4:"Four",5:"Five",6:"Six",7:"Seven",8:"Eight",9:"Nine",10:"Ten",J:"Jack",Q:"Queen",K:"King",A:"Ace"};le(()=>{console.log("Im destroun this !!!"),e.removeAllListeners(d.hit),e.removeAllListeners(d.checkToServer),e.removeAllListeners(d.checkToPlayers),e.removeAllListeners(d.kickPlayer),e.removeAllListeners(d.checkToPlayers),e.removeAllListeners(d.checkToPlayers)}),oe(()=>{e||n(2,e=ie(I)),e.on(d.hit,s=>{f=30,console.log("hit data is here",s),h&&(A(),N(2e3).then(()=>{r.gameClosed||F()})),console.log("is gameCLosed: ",r.gameClosed),r.gameClosed?A():(r.hit(s.move),n(0,r),N(3e3).then(()=>{}))}),h?(console.log("host"),n(0,r.gameClosed=!1,r),F(),e.on(d.checkToServer,s=>{r.previousBet&&(S=r.getCardCount(),x());let o=r.validateCheck();n(0,r),e.emit(d.checkToPlayers,o),e.emit(q.cardListToPlayers,S),r.eliminatedPlayers.forEach(g=>{g.uid==u}),r.players.length==1&&(n(0,r.gameClosed=!0,r),A(),k("gameFinished",r.players[0])),r.gameClosed||(A(),F())})):(console.log("non host"),e.on(d.checkToPlayers,s=>{console.log("recieved check",s),r.check(s),n(0,r),r.eliminatedPlayers.forEach(o=>{o.uid==u}),r.players.length==1&&k("gameFinished",r.players[0]),f=30}),e.on(d.kickPlayer,s=>{r.removePlayer(s),n(0,r),k("playerLeft",s)}),e.on(d.updateTimerToPlayers,s=>{f=s}),e.on(d.updateCardCountToPlayers,s=>{S=s,x()}))});function V(){f<=0&&N(2e3).then(()=>{if(f<=0)if(r.previousBet)j();else{const s={selectedRanking:"royal",primaryCard:"",secondaryCard:"",selectedColor:"spade",startingCard:""};e.emit(d.hit,{move:s})}})}function j(){console.log(h),e.emit(d.checkToServer)}function Q(){if(!r.previousBet)return"Error has occured.";const s=m=>m.charAt(0).toUpperCase()+m.slice(1);let{selectedRanking:o,primaryCard:g,secondaryCard:_,selectedColor:v,startingCard:T}=r.previousBet;o=s(o),g=s(g),_=s(_),v=s(v),T=s(T);let P=o;if(["One","Pair","Three","Four"].includes(o)){let m=b[g];return P+(o==="Pair"?" of ":" ")+m+(o!=="One"?"s":"")}if(["Double","Full"].includes(o)){let m=b[g],B=b[_];return P+(o==="Full"?" of 3 ":" of 2 ")+m+"s and 2 "+B+"s"}if(["Flush","Street"].includes(o)){let m=b[T];return P+" starting from "+m+(o==="Flush"?" in color "+v:"s")}return o==="Royal"?o+" Flush of "+v+"s":o+" "+v+"s"}function F(){C||(f=30,C=setInterval(()=>{f>0?f--:(V(),clearInterval(C),C=void 0),e.emit(q.timerUpdate,f)},1e5))}function A(){C&&clearInterval(C),C=void 0}function N(s){return console.log("prevbet",r.previousBet),new Promise(o=>setTimeout(o,s))}function x(){let s=de(S);w=[];const o={11:"j",12:"q",13:"k",14:"a"},g={4:"spade",3:"heart",2:"club",1:"diamond"};for(let[_,v]of s)for(let[T,P]of v)if(P==1){let m=o[_]||_.toString(),B=ue[m].string;w.push(B+" "+g[T])}}const W=()=>{n(1,L=!0)};return i.$$set=s=>{"gameId"in s&&n(3,a=s.gameId),"socket"in s&&n(2,e=s.socket),"kickPlayer"in s&&n(4,c=s.kickPlayer),"closeGame"in s&&n(5,l=s.closeGame),"thisPlayerId"in s&&n(6,u=s.thisPlayerId),"isHost"in s&&n(7,h=s.isHost),"game"in s&&n(0,r=s.game)},i.$$.update=()=>{i.$$.dirty&1&&r.previousBet&&Q()},[r,L,e,a,c,l,u,h,W]}class _e extends J{constructor(t){super(),M(this,t,ke,ye,O,{gameId:3,socket:2,kickPlayer:4,closeGame:5,thisPlayerId:6,isHost:7,game:0})}}export{_e as default};
